=====================================
Migrate Your App from Stitch to Realm
=====================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------
If you have an existing app built with the Stitch SDKs, you should migrate your 
app to use the new Realm SDKs. While much of the logic and flow of information 
hasn't changed, there are a few important changes in the way your app connects to 
the {+realm+} backend.

What's Changed?
---------------
This section provides an overview of the main changes. Below, you will find 
language-specific guidance for migrating your app.

- **Services**
   The {+realm+} SDKs do not provide hooks for calling Services (like the 
   :doc:`Twilio <services/twilio>` and :doc:`AWS <services/aws>` services). We 
   recommend using the AWS and/or Twilio ``npm`` packages within {+realm+} 
   functions to connect to these services moving forward. For more information, 
   see :doc:`Upload External Dependencies </functions/upload-external-dependencies>`.

- **Functions**
   Your app can still call server-side functions, but they are now called from the 
   ``Realm.User`` object instead of the ``App`` object. 

- **Authentication**
   Authentication methods are now called via Realm Credentials, and user logout now 
   occurs on the ``Realm.User`` object rather than the ``App`` object.


Updating Your Existing Application
----------------------------------
The changes in the {+realm+} SDKs are best described by how they have been 
implemented in each language. Select the tab for the language you are using to 
see specific details about migrating your existing Stitch app to the Realm SDKs.

.. note:: 

   If you are developing apps in  C# or Objective-C, there is no migration guidance, 
   since we did not provide Stitch SDKs for those languages. To get started with 
   these languages, refer to the SDK documentation sections above.

.. tabs-realm-sdks::

   .. tab::
      :tabid: android

      - Android applications written in Kotlin are now supported by the Realm Android SDK.

      - The Realm Android SDK now includes {+client-database+}, which includes local object storage and the ability to synchronize document changes across devices over the internet.

      - The backend app connections previously accessed via `com.mongodb.stitch.android.core.StitchAppClient <http://stitch-sdks.s3-website-us-east-1.amazonaws.com/stitch-sdks/java/4/com/mongodb/stitch/android/core/StitchAppClient.html>`__ are now accessed through :java-sdk:`io.realm.mongodb.App <io/realm/mongodb/App.html>`.

      - In Stitch, SDK requests like `callFunction() <http://stitch-sdks.s3-website-us-east-1.amazonaws.com/stitch-sdks/java/4/com/mongodb/stitch/android/core/StitchAppClient.html#callFunction(java.lang.String,java.util.List)>`__ were asynchronous by default. In the Realm Android SDK, you can choose synchronous or asynchronous requests with the "Async" suffix, e.g. :java-sdk:`callFunction() <io/realm/mongodb/functions/Functions.html#callFunction-java.lang.String-java.util.List-->` and :java-sdk:`callFunctionAsync() <io/realm/mongodb/functions/Functions.html#callFunctionAsync-java.lang.String-java.util.List--io.realm.mongodb.App.Callback->`.

      - Async SDK requests no longer use the built-in Android `Task <https://developers.google.com/android/reference/com/google/android/gms/tasks/Task.html?is-external=true>`__ class to return success status and values via ``onComplete()``; instead, Async requests now use a :java-sdk:`io.realm.mongodb.App.Callback <io/realm/mongodb/App.Callback.html>` to return success status and values via ``onResult()``.

      - Application users previously accessed via `com.mongodb.stitch.android.core.auth.StitchUser <http://stitch-sdks.s3-website-us-east-1.amazonaws.com/stitch-sdks/java/4/com/mongodb/stitch/android/core/auth/StitchUser.html>`__ are now accessed through :java-sdk:`io.realm.mongodb.User <io/realm/mongodb/User.html>`.

      - Login API has changed from `stitchAppClient.getAuth().loginWithCredential() <http://stitch-sdks.s3-website-us-east-1.amazonaws.com/stitch-sdks/java/4/com/mongodb/stitch/android/core/auth/StitchAuth.html#loginWithCredential(com.mongodb.stitch.core.auth.StitchCredential)>`__ to :java-sdk:`app.loginAsync() <io/realm/mongodb/App.html#login-io.realm.mongodb.Credentials->` or the synchronous equivalent :java-sdk:`app.login() <io/realm/mongodb/App.html#login-io.realm.mongodb.Credentials->`.

      - Instead of calling functions using the app client directly, like `stitchAppClient.callFunction() <http://stitch-sdks.s3-website-us-east-1.amazonaws.com/stitch-sdks/java/4/com/mongodb/stitch/android/core/StitchAppClient.html#callFunction(java.lang.String,java.util.List)>`__, you can only call functions through a :java-sdk`Functions Manager <io/realm/mongodb/functions/Functions.html>`, which you can access through the your backend realm app connection: :java-sdk:`app.getFunctions(user).callFunctionAsync() <io/realm/mongodb/functions/Functions.html#callFunctionAsync-java.lang.String-java.util.List--io.realm.mongodb.App.Callback->`.

      - The MongoDB Data Access API has changed packages from ``com.mongodb.client.MongoClient/MongoDatabase/MongoCollection`` to ``io.realm.mongodb.mongo.MongoClient/MongoDatabase/MongoCollection``

      - The BSON package, which contains MongoDB query filters and the ``Document`` data type for reading/writing to MongoDB Atlas and  has moved from ``com.mongodb.stitch.core.internal.common`` to ``org.bson``.

   .. tab::
      :tabid: ios

      Schwifty

   .. tab::
      :tabid: web

      Do we also need a tab for node?

   .. tab::
      :tabid: node

      Do we also need a tab for web?